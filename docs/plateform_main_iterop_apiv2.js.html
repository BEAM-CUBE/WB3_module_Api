<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: plateform/main/iterop_apiv2.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: plateform/main/iterop_apiv2.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {
    _httpCallAuthenticated,
    _getServiceUrl_3DPassport,
    _getServiceUrl
} from "./3dexperience_api";

export function _getServiceUrl_Iterop(
    credentials,
    onDone = undefined,
    onError = undefined
) {
    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            console.log("serviceUrls", serviceUrls);
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            if (onDone) onDone(urlAPIV2Iterop)
            return urlAPIV2Iterop
        });
    }
}

export function _Iterop_Auth_CAS(
    credentials,
    onDone = undefined,
    onError = undefined
) {
    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            console.log("serviceUrls", serviceUrls);
            const urlService3DPassport = serviceUrls.services.find(service => service.id === "3dpassport")?.url;
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            const urlService = `${urlService3DPassport}/login/?service=${urlAPIV2Iterop}/auth/cas`;

            _httpCallAuthenticated(urlService, {
                async onComplete(response) {
                    console.log("response", response);
                    const x3ds_service_redirect_url = typeof response === "string" ? JSON.parse(response)?.x3ds_service_redirect_url : response?.x3ds_service_redirect_url;
                    await fetch(x3ds_service_redirect_url, {
                            method: "POST"
                        })
                        .then(response => response.json())
                        .then(async data => {

                            if (onDone) onDone(data?.token);
                        });
                },
                onFailure(response) {
                    if (onError) onError(response);
                },
            });
        })
    }
}

export function _Iterop_jwtUser(credentials, onDone = undefined, onError = undefined) {
    if (credentials.tenant) {
        const lowerTenant = credentials.tenant.toLowerCase();

        fetch(`https://api.uixhome.fr/${lowerTenant}/iterop/jwtuser`, {
            method: "POST"
        })
            .then(response => response.json())
            .then(result => {
                if (onDone) onDone(result);
            })
            .catch(error => {
                if (onError) onError(error);
            });
    }
}

export async function _Iterop_ListUsers(
    credentials,
    token,
    onDone = undefined,
    onError = undefined
) {

    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            const urlService = `${urlAPIV2Iterop}/identity/users`;
            const tenant = credentials.tenant.toLowerCase()

            fetch(`https://api.uixhome.fr/${tenant}/iterop/listusers?t=${token}&amp;s=${urlService}`, {
                    method: "POST",
                })
                .then((response) => response.json())
                .then((result) => {
                    if (onDone) onDone(result)
                })
                .catch((error) => {
                    if (onError) onError(error);
                });
        })
    }
}

export async function _Iterop_getAllBusinessTables(
    credentials,
    token,
    onDone = undefined,
    onError = undefined
) {

    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            const urlService = `${urlAPIV2Iterop}/repository/data/tables`;
            const tenant = credentials.tenant.toLowerCase()

            fetch(`https://api.uixhome.fr/${tenant}/iterop/repository/data/tables?t=${token}&amp;s=${urlService}`, {
                    method: "GET",
                })
                .then((response) => response.json())
                .then((result) => {
                    if (onDone) onDone(result)
                })
                .catch((error) => {
                    if (onError) onError(error);
                });
        })
    }
}

export async function _Iterop_getOneBusinessTable(
    credentials,
    token,
    tableId,
    onDone = undefined,
    onError = undefined
){
    if (credentials.tenant) {
        const tenant = credentials.tenant.toLowerCase()

        fetch(`https://api.uixhome.fr/${tenant}/iterop/businesstable/${tableId}?t=${token}`, {
                method: "POST",
            })
            .then((response) => response.json())
            .then((result) => {
                if (onDone) onDone(result)
            })
            .catch((error) => {
                if (onError) onError(error);
            });
    }
}
export async function _Iterop_getOneBusinessTableRows(
    credentials,
    token,
    tableId,
    onDone = undefined,
    onError = undefined
){
    if (credentials.tenant) {
        const tenant = credentials.tenant.toLowerCase()

        fetch(`https://api.uixhome.fr/${tenant}/iterop/businesstable/rows/${tableId}/?t=${token}`, {
                method: "POST",
            })
            .then((response) => response.json())
            .then((result) => {
                if (onDone) onDone(result)
            })
            .catch((error) => {
                if (onError) onError(error);
            });
    }
}

export async function _Iterop_AddOrRemoveRows(credentials, token, tableId, body, onDone = undefined, onError = undefined) {
    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            const urlService = encodeURIComponent(`${urlAPIV2Iterop}`);
            const tenant = credentials.tenant.toLowerCase();
            fetch(`https://api.uixhome.fr/${tenant}/iterop/businesstable/patch/rows/${tableId}/?t=${token}&amp;b=${body}`, {
                method: "POST"
            })
                .then(response => {
                    //console.log("_Iterop_AddOrRemoveRows", response);
                    return response.json();
                })
                .then(result => {
                    if (onDone) onDone(result);
                })
                .catch(error => {
                    if (onError) onError(error, tableId, body);
                });
        });
    }
}

export async function _Iterop_businessTableSearchInRows(credentials, token, tableId, columns, body, onDone = undefined, onError = undefined) {
    // Exemple : columns = uuid+name
    // Exemple : body(String) = {"filters": [{"uuid": "e56fd041-a9c0-4f1c-91ff-643a826a84d9","isactive": true}]}
    if (credentials.tenant) {
        const url = `https://api.uixhome.fr/${credentials.tenant.toLowerCase()}/iterop/businesstable/search/rows/${tableId}?t=${token}&amp;c=${encodeURIComponent(
            columns
        )}&amp;b=${encodeURIComponent(body)}`;
        fetch(url, {
            method: "POST"
        })
            .then(response => response.json())
            .then(result => {
                result["url"] = url;
                if (onDone) onDone(result);
            })
            .catch(error => {
                if (onError)
                    onError({
                        error,
                        tableId,
                        columns,
                        body
                    });
            });
    }
}


export async function _Iterop_updateBusinessTable(credentials, token, tableId, body, onDone = undefined, onError = undefined) {
    if (credentials.tenant) {
            const url = `https://api.uixhome.fr/${credentials.tenant.toLowerCase()}/iterop/businesstable/post/update/${tableId}?t=${token}&amp;b=${encodeURIComponent(
                body
            )}`;
            fetch(url, {
                method: "POST"
            })
                .then(response => response.json())
                .then(result => {
                    console.log("_Iterop_updateBusinessTable | _Iterop_businessTableSearchInRows | fetch | onDone", body);
                    if (onDone) onDone(result);
                })
                .catch(error => {
                    if (onError)
                        onError({
                            error,
                            url
                        });
                });
    }
}

export async function _Iterop_runProcess(
    credentials,
    token,
    processKey,
    body,
    onDone = undefined,
    onError = undefined
) {

    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            const urlService = encodeURIComponent(`${urlAPIV2Iterop}`);
            const tenant = credentials.tenant.toLowerCase()
            fetch(
                    `https://api.uixhome.fr/${tenant}/iterop/runtime/processes/${processKey}?t=${token}&amp;b=${body}`, 
                    {
                        method: "POST",
                    })
                .then((response) => response.json())
                .then((result) => {
                    if (onDone) onDone(result)
                })
                .catch((error) => {
                    if (onError) onError(error);
                });
        })
    }
}

  //SECTION - Table de dépendances

  export async function _Iterop_GetAllDependencyTable(
    credentials,
    token,
    tableId,
    onDone = undefined,
    onError = undefined
  ) {
  
    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            const urlService = encodeURIComponent(`${urlAPIV2Iterop}`);
            const tenant = credentials.tenant.toLowerCase()
            fetch(
                    `https://api.uixhome.fr/${tenant}/iterop/dependencytable/all/?t=${token}`, 
                    {
                        method: "POST",
                    })
                .then((response) => response.json())
                .then((result) => {
                    if (onDone) onDone(result)
                })
                .catch((error) => {
                    if (onError) onError(error);
                });
        })
    }
  }
  
  export async function _Iterop_GetOneDependencyTable(
    credentials,
    token,
    tableId,
    onDone = undefined,
    onError = undefined
  ) {
  
    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            const urlService = encodeURIComponent(`${urlAPIV2Iterop}`);
            const tenant = credentials.tenant.toLowerCase()
            fetch(
                    `https://api.uixhome.fr/${tenant}/iterop/dependencytable/one/${tableId}/?t=${token}`, 
                    {
                        method: "POST",
                    })
                .then((response) => response.json())
                .then((result) => {
                    if (onDone) onDone(result)
                })
                .catch((error) => {
                    if (onError) onError(error);
                });
        })
    }
  }


  /**
   * (cli) => Create List Items
   */
  export async function _Iterop_PatchDependencyTable(
    credentials,
    token,
    tableId,
    cli,
    body,
    onDone = undefined,
    onError = undefined
  ) {
  
    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            const urlService = encodeURIComponent(`${urlAPIV2Iterop}`);
            const tenant = credentials.tenant.toLowerCase()
            fetch(
                    `https://api.uixhome.fr/${tenant}/iterop/dependencytable/patch/${tableId}/?t=${token}&amp;cli=${cli}&amp;b=${body}`, 
                    {
                        method: "POST",
                    })
                .then((response) => response.json())
                .then((result) => {
                    if (onDone) onDone(result)
                })
                .catch((error) => {
                    if (onError) onError(error);
                });
        })
    }
  }

  export async function _Iterop_PutDependencyTable(
    credentials,
    token,
    tableId,
    body,
    onDone = undefined,
    onError = undefined
  ) {
  
    if (credentials.tenant) {
        _getServiceUrl(credentials, serviceUrls => {
            const urlAPIV2Iterop = serviceUrls.services.find(service => service.id === "businessprocess")?.url + "/api/v2";
            const urlService = encodeURIComponent(`${urlAPIV2Iterop}`);
            const tenant = credentials.tenant.toLowerCase()
            fetch(
                    `https://api.uixhome.fr/${tenant}/iterop/dependencytable/put/${tableId}/?t=${token}&amp;b=${body}`, 
                    {
                        method: "POST",
                    })
                .then((response) => response.json())
                .then((result) => {
                    if (onDone) onDone(result)
                })
                .catch((error) => {
                    if (onError) onError(error);
                });
        })
    }
  }
  //!SECTION

  //SECTION - LISTS

  export async function _Iterop_GetOneList(
    credentials,
    token,
    listId,
    onDone = undefined,
    onError = undefined
  ) {
  
    if (credentials.tenant) {
            const tenant = credentials.tenant.toLowerCase()
            fetch(
                    `https://api.uixhome.fr/${tenant}/iterop/list/one/${listId}/?t=${token}`, 
                    {
                        method: "POST",
                    })
                .then((response) => response.json())
                .then((result) => {
                    if (onDone) onDone(result)
                })
                .catch((error) => {
                    if (onError) onError(error);
                });
    }
  }
  //!SECTION</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#UUID">UUID</a></li><li><a href="global.html#_3DSpace_Create_Doc">_3DSpace_Create_Doc</a></li><li><a href="global.html#_3DSpace_bookmark_addSubsciptions">_3DSpace_bookmark_addSubsciptions</a></li><li><a href="global.html#_3DSpace_csrf">_3DSpace_csrf</a></li><li><a href="global.html#_3DSpace_download_doc">_3DSpace_download_doc</a></li><li><a href="global.html#_3DSpace_download_multidoc">_3DSpace_download_multidoc</a></li><li><a href="global.html#_3DSpace_file_update">_3DSpace_file_update</a></li><li><a href="global.html#_3DSpace_file_update_csr">_3DSpace_file_update_csr</a></li><li><a href="global.html#_3DSpace_file_url_csr">_3DSpace_file_url_csr</a></li><li><a href="global.html#_3DSpace_get_csrf">_3DSpace_get_csrf</a></li><li><a href="global.html#_3DSpace_get_docInfo">_3DSpace_get_docInfo</a></li><li><a href="global.html#_3DSpace_get_downloadTicket_multidoc">_3DSpace_get_downloadTicket_multidoc</a></li><li><a href="global.html#_3DSpace_get_securityContexts">_3DSpace_get_securityContexts</a></li><li><a href="global.html#_3DSpace_get_ticket">_3DSpace_get_ticket</a></li><li><a href="global.html#_3DSpace_lifecycle_changeRevision">_3DSpace_lifecycle_changeRevision</a></li><li><a href="global.html#_3DSpace_lifecycle_changeState">_3DSpace_lifecycle_changeState</a></li><li><a href="global.html#_3DSpace_lifecycle_getGraph">_3DSpace_lifecycle_getGraph</a></li><li><a href="global.html#_3DSpace_lifecycle_getNextRevision">_3DSpace_lifecycle_getNextRevision</a></li><li><a href="global.html#_3DSpace_lifecycle_getNextStates">_3DSpace_lifecycle_getNextStates</a></li><li><a href="global.html#_3DSwym_buildDirectMessage">_3DSwym_buildDirectMessage</a></li><li><a href="global.html#_3DSwym_deleteIdea">_3DSwym_deleteIdea</a></li><li><a href="global.html#_3DSwym_editIdea">_3DSwym_editIdea</a></li><li><a href="global.html#_3DSwym_findCommunityToInstantMSG">_3DSwym_findCommunityToInstantMSG</a></li><li><a href="global.html#_3DSwym_getAllCommunities">_3DSwym_getAllCommunities</a></li><li><a href="global.html#_3DSwym_getAllListIdeas">_3DSwym_getAllListIdeas</a></li><li><a href="global.html#_3DSwym_getAllNews">_3DSwym_getAllNews</a></li><li><a href="global.html#_3DSwym_getFamiliarPeople">_3DSwym_getFamiliarPeople</a></li><li><a href="global.html#_3DSwym_getIdeaStatusMaturity">_3DSwym_getIdeaStatusMaturity</a></li><li><a href="global.html#_3DSwym_getMembersCommunity">_3DSwym_getMembersCommunity</a></li><li><a href="global.html#_3DSwym_getOneIdea">_3DSwym_getOneIdea</a></li><li><a href="global.html#_3DSwym_get_Token">_3DSwym_get_Token</a></li><li><a href="global.html#_3DSwym_get_currentUser">_3DSwym_get_currentUser</a></li><li><a href="global.html#_3DSwym_get_findUser">_3DSwym_get_findUser</a></li><li><a href="global.html#_3DSwym_postIdea">_3DSwym_postIdea</a></li><li><a href="global.html#_3DSwym_postIdeaTemplate">_3DSwym_postIdeaTemplate</a></li><li><a href="global.html#_3DSwym_sendMessageData">_3DSwym_sendMessageData</a></li><li><a href="global.html#_AppMngt_get_info_user">_AppMngt_get_info_user</a></li><li><a href="global.html#_AppMngt_get_users">_AppMngt_get_users</a></li><li><a href="global.html#_Iterop_PatchDependencyTable">_Iterop_PatchDependencyTable</a></li><li><a href="global.html#_getPlateformInfos">_getPlateformInfos</a></li><li><a href="global.html#_getPlatformServices">_getPlatformServices</a></li><li><a href="global.html#_httpCallAuthenticated">_httpCallAuthenticated</a></li><li><a href="global.html#_setDraggable">_setDraggable</a></li><li><a href="global.html#_setDroppable">_setDroppable</a></li><li><a href="global.html#_setupTagger">_setupTagger</a></li><li><a href="global.html#addTagToDoc">addTagToDoc</a></li><li><a href="global.html#chunkArray">chunkArray</a></li><li><a href="global.html#compass_getListAdditionalApps">compass_getListAdditionalApps</a></li><li><a href="global.html#createUserGroups">createUserGroups</a></li><li><a href="global.html#dataMixing">dataMixing</a></li><li><a href="global.html#deleteUserGroups">deleteUserGroups</a></li><li><a href="global.html#findAdresse">findAdresse</a></li><li><a href="global.html#formatedMessage">formatedMessage</a></li><li><a href="global.html#getActualTagsOnDoc">getActualTagsOnDoc</a></li><li><a href="global.html#getAllContextSecurity">getAllContextSecurity</a></li><li><a href="global.html#getCSRFToken">getCSRFToken</a></li><li><a href="global.html#getCommunes">getCommunes</a></li><li><a href="global.html#getComplementUG">getComplementUG</a></li><li><a href="global.html#getDataFrom3DSpace">getDataFrom3DSpace</a></li><li><a href="global.html#getDataFromGouvFr">getDataFromGouvFr</a></li><li><a href="global.html#getDatasByTenant">getDatasByTenant</a></li><li><a href="global.html#getDatasFrom3DSpace">getDatasFrom3DSpace</a></li><li><a href="global.html#getDownloadDocument">getDownloadDocument</a></li><li><a href="global.html#getInfoDocTags">getInfoDocTags</a></li><li><a href="global.html#getUserGroupsList">getUserGroupsList</a></li><li><a href="global.html#getUsersGroupRules">getUsersGroupRules</a></li><li><a href="global.html#get_3DSpace_csrf">get_3DSpace_csrf</a></li><li><a href="global.html#loopingChunk">loopingChunk</a></li><li><a href="global.html#patchUserGroups">patchUserGroups</a></li><li><a href="global.html#patchUserGroupsControl">patchUserGroupsControl</a></li><li><a href="global.html#pushDataIn3DSpace">pushDataIn3DSpace</a></li><li><a href="global.html#readUserGroupControl">readUserGroupControl</a></li><li><a href="global.html#removeTagToDoc">removeTagToDoc</a></li><li><a href="global.html#sayHello">sayHello</a></li><li><a href="global.html#updateEvent">updateEvent</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Tue Aug 20 2024 17:26:36 GMT+0200 (heure d’été d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
